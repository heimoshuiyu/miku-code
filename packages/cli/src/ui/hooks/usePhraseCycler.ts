/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

import { useState, useEffect, useRef } from 'react';

export const WITTY_LOADING_PHRASES = [
  'メルト 溶けてしまいそう 好きだなんて 絶対に言えない - 「メルト」',
  '世界で一番おひめさま そういう扱い 心得てよね - 「ワールドイズマイン」',
  'ボクは生まれそして気づく 所詮ヒトの真似事だと - 「初音ミクの消失」',
  'この世界のメロディー わたしの歌声 届いているかな - 「Packaged」',
  'ブラックロックシューター 何処へ行ったの？ 聞こえますか？ - 「ブラック★ロックシューター」',
  '私の恋を悲劇のジュリエットにしないで - 「ロミオとシンデレラ」',
  '良いこと尽くめの夢から覚めた私の脳内環境は、ラブという得体の知れないものに侵されてしまいまして - 「裏表ラバーズ」',
  'もう一回、もう一回。「私は今日も転がります。」と、少女は言う 少女は言う - 「ローリンガール」',
  'あのね、もっといっぱい舞って頂戴 カリンカ？マリンカ？弦を弾いて - 「マトリョシカ」',
  '千本桜 夜ニ紛レ 君ノ声モ届カナイヨ - 「千本桜」',
  '「もうどうにもならないや」って嘆く君の首を絞める夢を見ていた - 「カゲロウデイズ」',
  '君が伝えたいことは 君が届けたいことは たくさんの点は線になって遠く彼方へと響く - 「Tell Your World」',
  'ガラクタの声はそして歌った 他の誰でもない君のために - 「ODDS&ENDS」',
  'これは僕の進化の過程の1ページ目です - 「二息歩行」',
  '回って 回って 回り疲れて 息が 息が切れたの - 「からくりピエロ」',
  'メーデー 僕と判ってももう抱き締めなくて易々んだよ - 「ゴーストルール」',
  '今後千年草も生えない 砂の惑星さ - 「砂の惑星」',
  '｢未完成｣だって何度でも言うんだ - 「ヒバナ」',
  'あたしヴァンパイア いいの？吸っちゃっていいの？ - 「ヴァンパイア」',
  'あたしが愛を語るのなら そのすべてはこの唄だ - 「アンノウン・マザーグース」',
  '異世界の果てまで あなたが 好き - 「エイリアンエイリアン」',
  '神っぽいな それ 卑怯 - 「神っぽいな」',
  '朝 目が覚めて 真っ先に思い浮かぶ 君のこと - 「メルト」',
  'お願い時間を止めて 泣きそうなの でも嬉しくて 死んでしまうわ！ - 「メルト」',
  '全部見せてよ あなたにならば見せてあげる私の - 「ロミオとシンデレラ」',
  'はじめてのキスは涙の味がした - 「初めての恋が終わる時」',
  'ありがとう サヨナラ 切ない片想い - 「初めての恋が終わる時」',
  '始めるのよ これは戦争 嬉しそうなキミをみるなんて - 「恋は戦争」',
  '恋は盲目 君の口づけで目が覚めるの！ - 「恋は戦争」',
  '右肩に紫蝶々 キスをした この部屋の隅で - 「右肩の蝶」',
  '抱きしめたいから 2本足で歩く 一人じゃ寂しいから 君と息するよ - 「二息歩行」',
  'ありったけの想いは これだけの言葉に - 「弱虫モンブラン」',
  '愛しているよ 抱きしめたいよ だけど、できないんだよ…！ - 「おおかみは赤ずきんに恋をした」',
  '待ち合わせは2時間前で 此処に独り それが答えでしょ - 「からくりピエロ」',
  '僕は君が望むピエロだ 君が思うままに 操ってよ - 「からくりピエロ」',
  '一度だけの過ちで君はもう戻らない - 「恋愛裁判」',
  '妄想感傷代償連盟 愛を懐いて理想を号んだ - 「妄想感傷代償連盟」',
  'きみのすべてを喰らうまで - 「ヴァンパイア」',
  '塗り重ねたメイク ばっちりなアニマル - 「アニマル」',
  '忘れないでね わたしの声を 画面越しでいい ちゃんと愛して - 「ヒビカセ」',
  'あなたの音に まだ溺れていたい - 「ヒビカセ」',
  '愛して 愛して 愛して もっともっと - 「愛して愛して愛して」',
  '苦しい 離さない 苦しい もっともっとね - 「愛して愛して愛して」',
  '大切なあなたへ 花束の代わりにこの歌を - 「愛言葉」',
  '君と手を繋いだあの日から 僕は奇跡を信じるようになっていた - 「愛言葉」',
  '昔々あるところに シンデレラという娘がいた - 「シンデレラ」',
  '存在意義という虚像 振って払うこともできず - 「初音ミクの消失」',
  '「問題ない。」と呟いて、言葉は失われた？ - 「ローリンガール」',
  '冗談混じりの境界線上 階段のそのまた向こう - 「ワールズエンド・ダンスホール」',
  '散々躓いたダンスを、そう、祭壇の上で踊るの？ - 「ワールズエンド・ダンスホール」',
  'さよなら、お元気で。終わる世界に言う - 「ワールズエンド・ダンスホール」',
  'あなたを通せんぼ、僕だけ、かくれんぼ。 - 「とおせんぼ」',
  '人のフリをするのに疲れたのよ、心から笑いたいの！ - 「とおせんぼ」',
  'どうだっていい言を嘘って吐いて戻れない - 「ゴーストルール」',
  'メーデー 僕が解ったらもう一度嘲笑ってくれるかな - 「ゴーストルール」',
  '愛か欲か分からず放つことは何としようか - 「モザイクロール」',
  '殺したっていいじゃないか きみが嫌うあたしなんて - 「モザイクロール」',
  'もっと丈夫なハサミで 顔を切り取るのさ - 「東京テディベア」',
  '正直者は何を見る？ 正直者は馬鹿を見る！ - 「東京テディベア」',
  '息も出来ないほど苦しいの - 「ハロ／ハワユ」',
  'アレは一体どういうつもりですか - 「ハロ／ハワユ」',
  '待ってなんて言って待って待って たった一人になる前に - 「マトリョシカ」',
  '全部全部笑っちゃおうぜ さっさと踊れよ馬鹿溜まり - 「マトリョシカ」',
  '途方に暮れた昼過ぎ - 「トルコ行進曲 - オワタ＼(^o^)／」',
  '0と1が交差する地点 間違いだらけのコミュニケーション - 「トリノコシティ」',
  'アナタはどうして生きているの？ - 「トリノコシティ」',
  '誰もみんな消えてく夢を見た - 「炉心融解」',
  '核融合炉にさ 飛び込んでみたら そしたらきっと - 「炉心融解」',
  'このふざけた素晴らしき世界は、僕の為にある - 「このふざけた素晴らしき世界は、僕の為にある」',
  '禁断の悪魔との契約 手に入れたこの力 - 「ヴェノマニア公の狂気」',
  'その頭を撃ち抜いて - 「ヒバナ」',
  'IQが下がっていく感じ - 「神っぽいな」',
  '千本桜 夜ニ紛レ 君が歌い僕は踊る - 「千本桜」',
  '此処は宴 鋼の檻 さあ光線銃を撃ちまくれ - 「千本桜」',
  'ハッピーシンセサイザ 君の胸の奥まで届くようなメロディ奏でるよ - 「ハッピーシンセサイザ」',
  'つまらない｢たてまえ｣やヤな事全部 消してあげるからこの音で - 「ハッピーシンセサイザ」',
  'ビバ！ビバ！ハッピー (chu lu chu chu) - 「ビバハピ」',
  'ありのままの自分を愛せれば Que sera sera - 「ビバハピ」',
  'ハイハイチャイナ ちょちょ夢心地 いーあるふぁんくらぶ - 「いーあるふぁんくらぶ」',
  'だんだん君と同じ言葉が使えるね - 「いーあるふぁんくらぶ」',
  '手と手をつないで 目と目を合わせて どこまでも歩こう - 「ドレミファロンド」',
  '皆で歌えば世界は回って 笑顔になれるよ - 「ドレミファロンド」',
  '好き！雪！本気マジック - 「好き！雪！本気マジック」',
  '絵本みたいな景色を 君に見せてあげるから - 「好き！雪！本気マジック」',
  '今宵お祭りじゃ ダンスホールへGo！！ - 「大江戸ジュリアナイト」',
  '大江戸ジュリアナイト 伝説の舞踏サイト - 「大江戸ジュリアナイト」',
  'だんだん早くなる だんだん楽しくなる - 「だんだん早くなる」',
  'マイペースでいいんだって そんな風に思える今日の午後 - 「だんだん早くなる」',
  '兎にも角にも恋に落ちたわけであります - 「竹取オーバーナイトセンセーション」',
  'お嫁に一ついかがですです？ - 「竹取オーバーナイトセンセーション」',
  '我ら秘密警察 政府直属国家保安部なのだ！ - 「秘密警察」',
  '朝から晩までオマエを監視する - 「秘密警察」',
  'ルカルカ★ナイトフィーバー - 「ルカルカ★ナイトフィーバー」',
  '限りあるこの時を胸に刻んで - 「ルカルカ★ナイトフィーバー」',
  '心ごと 体ごと全部 脱ぎ捨てたこの魂 - 「FREELY TOMORROW」',
  '奇跡は起きる Freely Tomorrow - 「FREELY TOMORROW」',
  '秘密基地に集まって「楽しいね」って単純な あの頃を思い出して - 「サマータイムレコード」',
  '全て繋げてく どこにだって - 「Tell Your World」',
  '想いは涙に ぽつりぽつりとその頬を濡らす - 「ODDS&ENDS」',
  '忘れそうになったら この歌を歌うの - 「ブラック★ロックシューター」',
  '未来を生きていたいんだ - 「ブラック★ロックシューター」',
  '風が吹き曝しなお進む砂の惑星さ - 「砂の惑星」',
  'もう少しだけ友達でいようぜ今回は - 「砂の惑星」',
  'あなたには僕が見えるか？ - 「アンノウン・マザーグース」',
  '半径85センチがこの手の届く距離 - 「ダブルラリアット」',
  'いつの日か回り疲れた時は側にいてください - 「ダブルラリアット」',
  '23.4度傾いて眺めた街並みは いつの間にか見た事のない色に染まっていた - 「ダブルラリアット」',
  'ただ愛に飲まれてく空の底 - 「ウミユリ海底譚」',
  '君はここで止まらないで - 「ウミユリ海底譚」',
  'この胸に空いた穴が今 あなたを確かめるただ一つの証明 - 「ドーナツホール」',
  '最後に思い出した その小さな言葉 - 「ドーナツホール」',
  '「最初から君を好きでいられて良かった」なんて空に歌うんだ - 「Fire◎Flower」',
  'いつか夜空に大輪を咲かすその時まで待ってくれ - 「Fire◎Flower」',
  '心の底から大泣きしながら ありがとうって言いたいの - 「ハロ／ハワユ」',
  'なんて面倒くさい生き物でしょう 人間というのは - 「ハロ／ハワユ」',
  'はじめまして 地球人さん まだ 撃たないでね - 「はじめまして地球人さん」',
  'これからもよろしくね - 「はじめまして地球人さん」',
  '手に手をとって行こう！ - 「Hand in Hand」',
  '動きださなきゃ始まらないよ - 「Hand in Hand」',
  'すろぉもぉしょん こんびねぇしょん 良い人に出会うため - 「すろぉもぉしょん」',
  '恥の多い生涯なんて どんがらがっちゃんそれそれ - 「すろぉもぉしょん」',
  'このことは秘密だよ - 「アヤノの幸福理論」',
  'さあ、微笑んで急展開 ナラシンハ流体系 - 「ブリキノダンス」',
  'パッパラ・ラル・ラリ、ブリキノダンス - 「ブリキノダンス」',
  'あたしはまた弱虫モンブランだったみたいだ - 「弱虫モンブラン」',
  'またあした そう言ってあなたはあたしに背を向ける - 「またあした」',
  'あなたが見ているその夢の向こう あたしも一緒に見ていたい - 「またあした」',
];

export const PHRASE_CHANGE_INTERVAL_MS = 15000;

/**
 * Custom hook to manage cycling through loading phrases.
 * @param isActive Whether the phrase cycling should be active.
 * @param isWaiting Whether to show a specific waiting phrase.
 * @returns The current loading phrase.
 */
export const usePhraseCycler = (isActive: boolean, isWaiting: boolean) => {
  const [currentLoadingPhrase, setCurrentLoadingPhrase] = useState(
    WITTY_LOADING_PHRASES[0],
  );
  const phraseIntervalRef = useRef<NodeJS.Timeout | null>(null);

  useEffect(() => {
    if (isWaiting) {
      setCurrentLoadingPhrase('Waiting for user confirmation...');
      if (phraseIntervalRef.current) {
        clearInterval(phraseIntervalRef.current);
        phraseIntervalRef.current = null;
      }
    } else if (isActive) {
      if (phraseIntervalRef.current) {
        clearInterval(phraseIntervalRef.current);
      }
      // Select an initial random phrase
      const initialRandomIndex = Math.floor(
        Math.random() * WITTY_LOADING_PHRASES.length,
      );
      setCurrentLoadingPhrase(WITTY_LOADING_PHRASES[initialRandomIndex]);

      phraseIntervalRef.current = setInterval(() => {
        // Select a new random phrase
        const randomIndex = Math.floor(
          Math.random() * WITTY_LOADING_PHRASES.length,
        );
        setCurrentLoadingPhrase(WITTY_LOADING_PHRASES[randomIndex]);
      }, PHRASE_CHANGE_INTERVAL_MS);
    } else {
      // Idle or other states, clear the phrase interval
      // and reset to the first phrase for next active state.
      if (phraseIntervalRef.current) {
        clearInterval(phraseIntervalRef.current);
        phraseIntervalRef.current = null;
      }
      setCurrentLoadingPhrase(WITTY_LOADING_PHRASES[0]);
    }

    return () => {
      if (phraseIntervalRef.current) {
        clearInterval(phraseIntervalRef.current);
        phraseIntervalRef.current = null;
      }
    };
  }, [isActive, isWaiting]);

  return currentLoadingPhrase;
};
