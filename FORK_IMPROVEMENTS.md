# Qwen Code Fork æ”¹è¿›ç‚¹æ–‡æ¡£

## æ¦‚è¿°

æœ¬æ–‡æ¡£è®°å½•äº†ç›¸å¯¹äº `origin/main` åˆ†æ”¯ï¼Œè¯¥ fork é¡¹ç›®æ‰€åšçš„ä¸»è¦æ”¹è¿›å’Œä¼˜åŒ–ã€‚å½“å‰åˆ†æ”¯é¢†å…ˆ `origin/main` 6 ä¸ªæäº¤ï¼ŒåŒ…å«åŠŸèƒ½å¢å¼ºã€ä»£ç é‡æ„å’Œç”¨æˆ·ä½“éªŒæ”¹è¿›ã€‚

## ä¸»è¦æ”¹è¿›ç‚¹

### 1. ç³»ç»Ÿæ¶ˆæ¯æ§åˆ¶åŠŸèƒ½ ğŸ†•

**æäº¤**: `c2817be` - feat: disable system messages by default in config  
**æäº¤**: `7f6f2d0` - feat: add system command and enhance builtin command loader with config updates

#### æ”¹è¿›å†…å®¹ï¼š
- **é»˜è®¤ç¦ç”¨ç³»ç»Ÿæ¶ˆæ¯**ï¼šåœ¨é…ç½®ä¸­å°† `enableSystemMessage` é»˜è®¤å€¼è®¾ä¸º `false`ï¼Œå‡å°‘ä¸å¿…è¦çš„ç³»ç»Ÿæ¶ˆæ¯å¹²æ‰°
- **æ–°å¢ `/system` å‘½ä»¤**ï¼šæä¾›å®Œæ•´çš„ç³»ç»Ÿæ¶ˆæ¯æ§åˆ¶åŠŸèƒ½
  - `/system on` - å¯ç”¨ç³»ç»Ÿæ¶ˆæ¯
  - `/system off` - ç¦ç”¨ç³»ç»Ÿæ¶ˆæ¯  
  - `/system status` - æŸ¥çœ‹å½“å‰çŠ¶æ€

#### å½±å“æ–‡ä»¶ï¼š
- `packages/core/src/config/config.ts` - é…ç½®ç³»ç»Ÿ
- `packages/cli/src/ui/commands/systemCommand.ts` - æ–°å¢ç³»ç»Ÿå‘½ä»¤
- `packages/cli/src/services/BuiltinCommandLoader.ts` - å‘½ä»¤åŠ è½½å™¨å¢å¼º
- `packages/core/src/core/openaiContentGenerator.ts` - å†…å®¹ç”Ÿæˆå™¨é€‚é…

### 2. ç¯å¢ƒå˜é‡ Token é™åˆ¶é…ç½® ğŸ†•

**æäº¤**: `348b21f` - feat: DEFAULT_TOKEN_LIMIT env

#### æ”¹è¿›å†…å®¹ï¼š
- **ç¯å¢ƒå˜é‡æ”¯æŒ**ï¼šé€šè¿‡ `DEFAULT_TOKEN_LIMIT` ç¯å¢ƒå˜é‡è‡ªå®šä¹‰é»˜è®¤ token é™åˆ¶
- **çµæ´»é…ç½®**ï¼šæ”¯æŒæ•°å€¼æ ¼å¼ï¼ˆå¦‚ `1000000`ï¼‰å’Œå•ä½æ ¼å¼ï¼ˆå¦‚ `1M`ã€`1024K`ï¼‰
- **å‘åå…¼å®¹**ï¼šæœªè®¾ç½®ç¯å¢ƒå˜é‡æ—¶ä½¿ç”¨é»˜è®¤å€¼ 1,048,576 tokens

#### å½±å“æ–‡ä»¶ï¼š
- `packages/core/src/core/tokenLimits.ts` - Token é™åˆ¶é€»è¾‘

### 3. ç§»é™¤è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ ğŸ—‘ï¸

**æäº¤**: `b408b09` - refac: remove auto-update functionality and related components

#### æ”¹è¿›å†…å®¹ï¼š
- **ç®€åŒ–æ¶æ„**ï¼šå®Œå…¨ç§»é™¤è‡ªåŠ¨æ›´æ–°ç›¸å…³åŠŸèƒ½ï¼Œå‡å°‘ä»£ç å¤æ‚åº¦
- **æ¸…ç†ä¾èµ–**ï¼šåˆ é™¤å¤§é‡æµ‹è¯•æ–‡ä»¶å’Œå®ç°ä»£ç 
- **æå‡ç¨³å®šæ€§**ï¼šé¿å…è‡ªåŠ¨æ›´æ–°å¯èƒ½å¸¦æ¥çš„ä¸ç¨³å®šå› ç´ 

#### åˆ é™¤æ–‡ä»¶ï¼š
- `packages/cli/src/ui/components/UpdateNotification.tsx`
- `packages/cli/src/ui/utils/updateCheck.ts`
- `packages/cli/src/utils/handleAutoUpdate.ts`
- `packages/cli/src/utils/installationInfo.ts`
- `packages/cli/src/utils/updateEventEmitter.ts`
- ç›¸å…³æµ‹è¯•æ–‡ä»¶ï¼ˆå…±åˆ é™¤ 2726 è¡Œä»£ç ï¼‰

### 4. Ascii Art ä¼˜åŒ– ğŸ¨

**æäº¤**: `47a5bb3` - refac: MIKU AsciiArt

#### æ”¹è¿›å†…å®¹ï¼š
- **ä»£ç ç®€åŒ–**ï¼šé‡æ„ AsciiArt ç»„ä»¶ï¼Œå‡å°‘ä»£ç é‡å¤
- **ç»Ÿä¸€é£æ ¼**ï¼šä¿æŒä¸‰ç§å°ºå¯¸çš„ logo é£æ ¼ä¸€è‡´
- **æ€§èƒ½ä¼˜åŒ–**ï¼šç§»é™¤å†—ä½™çš„å¯¼å‡ºå’Œå®šä¹‰

#### å½±å“æ–‡ä»¶ï¼š
- `packages/cli/src/ui/components/AsciiArt.ts`

## æŠ€æœ¯æ”¹è¿›æ€»ç»“

### ä»£ç è´¨é‡æå‡
- âœ… ç§»é™¤å†—ä½™çš„è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼Œç®€åŒ–ä»£ç æ¶æ„
- âœ… é‡æ„ AsciiArt ç»„ä»¶ï¼Œæé«˜ä»£ç å¯ç»´æŠ¤æ€§
- âœ… å¢å¼ºé…ç½®ç³»ç»Ÿçš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§

### ç”¨æˆ·ä½“éªŒæ”¹è¿›
- âœ… æä¾›ç³»ç»Ÿæ¶ˆæ¯çš„ç²¾ç»†æ§åˆ¶ï¼Œå‡å°‘å¹²æ‰°
- âœ… æ”¯æŒç¯å¢ƒå˜é‡é…ç½®ï¼Œæé«˜éƒ¨ç½²çµæ´»æ€§
- âœ… ç®€åŒ–åŠŸèƒ½é›†ï¼Œä¸“æ³¨äºæ ¸å¿ƒä»·å€¼

### ç³»ç»Ÿç¨³å®šæ€§
- âœ… ç§»é™¤è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼Œé¿å…æ½œåœ¨çš„ç¨³å®šæ€§é—®é¢˜
- âœ… å¢å¼ºé…ç½®éªŒè¯å’Œé”™è¯¯å¤„ç†
- âœ… ä¿æŒå‘åå…¼å®¹æ€§

## é…ç½®è¯´æ˜

### æ–°å¢é…ç½®é¡¹
```typescript
// ç³»ç»Ÿæ¶ˆæ¯æ§åˆ¶ï¼ˆé»˜è®¤ç¦ç”¨ï¼‰
enableSystemMessage: boolean = false

// é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®é»˜è®¤ token é™åˆ¶
// æ”¯æŒæ ¼å¼ï¼š1000000, 1M, 1024K
process.env.DEFAULT_TOKEN_LIMIT
```

### ä½¿ç”¨ç¤ºä¾‹
```bash
# è®¾ç½®é»˜è®¤ token é™åˆ¶
export DEFAULT_TOKEN_LIMIT=2M

# åœ¨ CLI ä¸­æ§åˆ¶ç³»ç»Ÿæ¶ˆæ¯
/system on    # å¯ç”¨ç³»ç»Ÿæ¶ˆæ¯
/system off   # ç¦ç”¨ç³»ç»Ÿæ¶ˆæ¯
/system status # æŸ¥çœ‹çŠ¶æ€
```

## åç»­å»ºè®®

1. **æ–‡æ¡£æ›´æ–°**ï¼šæ›´æ–°ç”¨æˆ·æ–‡æ¡£è¯´æ˜æ–°çš„é…ç½®é€‰é¡¹å’Œå‘½ä»¤
2. **æµ‹è¯•è¦†ç›–**ï¼šä¸ºæ–°å¢åŠŸèƒ½æ·»åŠ å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹
3. **æ€§èƒ½ç›‘æ§**ï¼šç›‘æ§ token é™åˆ¶é…ç½®å¯¹æ€§èƒ½çš„å½±å“
4. **ç”¨æˆ·åé¦ˆ**ï¼šæ”¶é›†ç”¨æˆ·å¯¹ç³»ç»Ÿæ¶ˆæ¯æ§åˆ¶åŠŸèƒ½çš„åé¦ˆ

---

*æ–‡æ¡£ç”Ÿæˆæ—¶é—´ï¼š2025-09-04*  
*åŸºäºæäº¤ï¼šc2817be (é¢†å…ˆ origin/main 6 ä¸ªæäº¤)*